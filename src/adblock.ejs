<!DOCTYPE html>
<html lang="en">
	<%- include('partials/head.ejs',
		{
			page:'adblock',
			title:'Test Ad Block - Toolz',
			description:'Test your ad blocker effectiveness with this comprehensive test. Check how well your ad blocker handles various ad networks, trackers, and analytics services.',
			url: 'd3ward.github.io/toolz/adblock',
			preview_thumbnail:'https://d3ward.github.io/toolz/src/preview_toolz.png',
			keywords:'adblock test,ad block test,ad blocker test,adblock,test adblock,analytics,trackers,ads,cosmetic filter,ublock, ublockorigin,adblock extension,script loading'
		}) %>
	<body>
		<%- include('partials/support_me.ejs') %>
		<%- include('partials/adblock/changelog.ejs') %>
		<%- include('partials/header.ejs', {page:'adblock'}) %>

        <!-- Custom styles for modern look -->
        <style>
            body {
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            }
            
            .modern-card {
                background-color: var(--bg, white);
                border-radius: 16px;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
                padding: 40px;
                width: 100%;
                max-width: 450px;
                margin: 0 auto;
                transition: all 0.3s ease;
            }
            
            .modern-card h1 {
                margin-top: 0;
                font-weight: 700;
                font-size: 2rem;
                color: var(--txt, #111111);
                margin-bottom: 8px;
            }
            
            .modern-card p {
                color: var(--txt-2, #444444);
                font-size: 1rem;
                margin-bottom: 32px;
            }
            
            .modern-input {
                width: 100%;
                padding: 14px 20px;
                border-radius: 8px;
                border: 1px solid var(--brd, #cccccc);
                font-size: 1rem;
                color: var(--txt, #333333);
                outline: none;
                transition: all 0.2s ease;
                margin-bottom: 16px;
                background-color: var(--bg-2, #f9f9f9);
            }
            
            .modern-input:focus {
                border-color: var(--primary, #222222);
                box-shadow: 0 0 0 3px var(--primary-h, rgba(0, 0, 0, 0.1));
            }
            
            .modern-button {
                width: 100%;
                padding: 14px 20px;
                border-radius: 8px;
                border: none;
                background-color: var(--primary, #222222);
                color: white;
                font-weight: 600;
                font-size: 1rem;
                cursor: pointer;
                transition: all 0.2s ease;
            }
            
            .modern-button:hover {
                background-color: var(--primary-d, #000000);
                transform: translateY(-1px);
            }
            
            .modern-button:active {
                transform: translateY(1px);
            }
            
            .lock-icon {
                display: block;
                width: 64px;
                height: 64px;
                margin: 0 auto 24px;
                color: var(--primary, #222222);
            }
            
            .error-message {
                background-color: #fee2e2;
                border-left: 4px solid #ef4444;
                padding: 12px 16px;
                color: #b91c1c;
                font-size: 0.875rem;
                margin-top: 16px;
                border-radius: 4px;
                display: none;
            }
            
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            
            .fade-in {
                animation: fadeIn 0.5s ease forwards;
            }
            
            .page-container {
                min-height: calc(100vh - 200px);
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            }
            
            /* Additional modern styles for test section */
            .btn-primary, .btn-secondary {
                padding: 14px 20px;
                border-radius: 8px;
                font-weight: 600;
                font-size: 1rem;
                cursor: pointer;
                transition: all 0.2s ease;
                margin-right: 10px;
                margin-top: 10px;
                border: none;
                outline: none;
            }
            
            .btn-primary {
                background-color: var(--primary, #222222);
                color: white;
            }
            
            .btn-primary:hover {
                background-color: var(--primary-d, #000000);
                transform: translateY(-1px);
            }
            
            .btn-secondary {
                background-color: var(--bg-2, #f5f5f5);
                color: var(--txt, #333333);
                border: 1px solid var(--brd, #ddd);
            }
            
            .btn-secondary:hover {
                background-color: var(--bg, #ffffff);
                transform: translateY(-1px);
            }
            
            ._bg-gray {
                background-color: var(--bg, white) !important;
                border: 1px solid var(--brd, #ddd) !important;
            }
            
            ._bg-white {
                background-color: var(--bg, white) !important;
                color: var(--txt, #333333) !important;
            }
            
            /* Better progress bar */
            .progress-container {
                width: 100%;
                height: 8px;
                background-color: var(--bg-2, #f5f5f5);
                border-radius: 4px;
                margin: 20px 0;
                overflow: hidden;
            }
            
            .progress-bar {
                height: 100%;
                background-color: var(--primary, #222222);
                border-radius: 4px;
                transition: width 0.3s ease;
                width: 0%;
            }
        </style>

		<!-- Password protection layer -->
		<div id="password-protection" class="page-container" style="display: none;">
			<div class="fade-in modern-card">
				<svg class="lock-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M16 8V6C16 3.79086 14.2091 2 12 2C9.79086 2 8 3.79086 8 6V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
					<path d="M5 10H19C20.1046 10 21 10.8954 21 12V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V12C3 10.8954 3.89543 10 5 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
					<path d="M12 17C12.5523 17 13 16.5523 13 16C13 15.4477 12.5523 15 12 15C11.4477 15 11 15.4477 11 16C11 16.5523 11.4477 17 12 17Z" fill="currentColor"/>
					<path d="M12 17V19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
				</svg>
				
				<h1>AdBlock Tester</h1>
				<p>Enter your password to access the AdBlock testing tools</p>
				
				<input type="password" id="password-input" class="modern-input" placeholder="Enter password">
				<button id="password-submit" class="modern-button">Unlock Access</button>
				
				<div id="password-error" class="error-message">
					<strong>Access denied:</strong> The password you entered is incorrect. Please try again.
				</div>
			</div>
		</div>

		<main id="main-content" style="display: none;">
			<noscript>
				<div class="_bg-red _txt-white _radius _p-1 better_r _py-2 _mt-2">
					<h3>JavaScript is required to run this test. Please enable JavaScript in your browser settings.</h3>
					<style>
						#m_test{
							display: none;
						}
					</style>
				</div>
			</noscript>

			<section id="m_test" class="_mh-100 _py-2">
				<div>
					<div class="_bg-gray _radius _p-1 better_r _mb-1">
						<p>Test your ad blocker's effectiveness against a wide range of advertising, tracking, and analytics domains.</p>
						<button id="start_test" class="btn-primary">Start Test</button>
						<button id="settings_btn" class="btn-secondary">Settings</button>
					</div>
					
					<div id="test_results" class="_bg-white _radius _p-1 better_r _mb-1" style="display: none; background-color: white !important; color: #333333;">
						<h2>Test Results</h2>
						<div class="results-summary">
							<div class="score-container">
								<div id="score_circle" class="score-circle">
									<span id="score_text">0%</span>
								</div>
							</div>
							<div class="results-details">
								<p><strong>Blocked:</strong> <span id="blocked_count">0</span>/<span id="total_count">0</span></p>
								<p><strong>Ad Servers:</strong> <span id="ads_score">0%</span></p>
								<p><strong>Trackers:</strong> <span id="trackers_score">0%</span></p>
								<p><strong>Analytics:</strong> <span id="analytics_score">0%</span></p>
							</div>
						</div>
						<div id="detailed_results" class="detailed-results">
							<!-- Results will be populated here by JavaScript -->
						</div>
					</div>
					
					<div id="test_running" class="_bg-white _radius _p-1 better_r _mb-1" style="display: none;">
						<h2>Testing in progress...</h2>
						<div class="progress-container">
							<div id="progress_bar" class="progress-bar"></div>
						</div>
						<p id="current_test">Preparing tests...</p>
					</div>
				</div>
			</section>
			
			<%- include('partials/adblock/settings.ejs') %>
		</main>
		
		<%- include('partials/footer.ejs') %>
		<%- include('partials/gotop.ejs') %>
		
		<!-- Add test scripts -->
		<script src="js/adblock-test.js" defer></script>
		
		<!-- Authentication Script -->
		<script>
			document.addEventListener('DOMContentLoaded', function() {
				const correctPassword = "ams505";
				const passwordProtection = document.getElementById('password-protection');
				const mainContent = document.getElementById('main-content');
				const passwordInput = document.getElementById('password-input');
				const passwordSubmit = document.getElementById('password-submit');
				const passwordError = document.getElementById('password-error');
				
				// Check if authenticated
				const isAuthenticated = localStorage.getItem('adblock_tester_auth');
				
				if (isAuthenticated === 'true') {
					// User is authenticated, show content
					passwordProtection.style.display = 'none';
					mainContent.style.display = 'block';
				} else {
					// User is not authenticated, show password form
					passwordProtection.style.display = 'flex';
					mainContent.style.display = 'none';
					
					// Password verification
					passwordSubmit.addEventListener('click', verifyPassword);
					passwordInput.addEventListener('keypress', function(e) {
						if (e.key === 'Enter') {
							verifyPassword();
						}
					});
                    
                    // Auto-focus on the password input field
                    passwordInput.focus();
				}
				
				function verifyPassword() {
					if (passwordInput.value === correctPassword) {
						// Store authentication in localStorage
						localStorage.setItem('adblock_tester_auth', 'true');
						
						// Show content
						passwordProtection.style.display = 'none';
						mainContent.style.display = 'block';
					} else {
						// Show error
						passwordError.style.display = 'block';
						passwordInput.value = '';
                        passwordInput.focus();
					}
				}
			});
		</script>
	</body>
</html>
